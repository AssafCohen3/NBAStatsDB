PlayerSeasonAtTeam
CREATE VIEW PlayerSeasonAtTeam as
    select SEASON, PLAYER_NAME, PLAYER_ID, TEAM_ID, TEAM_NAME from BoxScore group by SEASON, PLAYER_ID, TEAM_ID
/* PlayerSeasonAtTeam(SEASON,PLAYER_NAME,PLAYER_ID,TEAM_ID,TEAM_NAME) */;
***********************************
PlayerCareerTeams
CREATE VIEW PlayerCareerTeams as
    select PLAYER_NAME, PLAYER_ID, TEAM_NAME, TEAM_ID, count(distinct SEASON) as SeasonsAt from PlayerSeasonAtTeam group by PLAYER_ID, TEAM_ID
/* PlayerCareerTeams(PLAYER_NAME,PLAYER_ID,TEAM_NAME,TEAM_ID,SeasonsAt) */;
***********************************
PlayerTeamMostSeasons
CREATE VIEW PlayerTeamMostSeasons as
    SELECT PLAYER_NAME, PLAYER_ID, TEAM_NAME, TEAM_ID, SeasonsAt FROM (
    SELECT ROW_NUMBER() OVER (PARTITION BY PLAYER_ID ORDER BY SeasonsAt DESC) as RowNum, *
    FROM PlayerCareerTeams
) C
WHERE RowNum = 1
/* PlayerTeamMostSeasons(PLAYER_NAME,PLAYER_ID,TEAM_NAME,TEAM_ID,SeasonsAt) */;
***********************************
PlayerCareer
CREATE VIEW PlayerCareer as
    select PLAYER_NAME, PLAYER_ID, min(SEASON) as FirstYear, count(distinct SEASON) as CareerLength, max(SEASON) as LastYear from BoxScore group by PLAYER_ID
/* PlayerCareer(PLAYER_NAME,PLAYER_ID,FirstYear,CareerLength,LastYear) */;
***********************************
TeamsCount
CREATE VIEW TeamsCount as
    select SEASON, count(distinct TEAM_ID) as TeamsNumber from BoxScore group by SEASON
/* TeamsCount(SEASON,TeamsNumber) */;
***********************************
PlayerSeason
CREATE VIEW PlayerSeason as
    select PLAYER_NAME, PLAYER_ID, SEASON, group_concat(distinct TEAM_NAME) as teams from BoxScore group by PLAYER_ID, SEASON
/* PlayerSeason(PLAYER_NAME,PLAYER_ID,SEASON,teams) */;
***********************************
PlayerTeamsCount
CREATE VIEW PlayerTeamsCount as
    select PLAYER_NAME, PLAYER_ID, count(distinct TEAM_ID) as PlayerTeamNumber from BoxScore group by PLAYER_ID
/* PlayerTeamsCount(PLAYER_NAME,PLAYER_ID,PlayerTeamNumber) */;
***********************************
PlayerAdjustedTeamsNumber
CREATE VIEW PlayerAdjustedTeamsNumber as
    select PlayerSeason.PLAYER_NAME, PlayerSeason.PLAYER_ID, round(avg(TC.TeamsNumber), 2) as AverageTeamNumber,
       min(PlayerSeason.SEASON) as FirstYear, count(distinct PlayerSeason.SEASON) as CareerLength,
       max(PlayerSeason.SEASON) as LastYear, PlayerTeamNumber,
       round(PlayerTeamNumber * (30/avg(TC.TeamsNumber)), 2) as AdjustedTeamNumber from PlayerSeason
    join TeamsCount TC on PlayerSeason.SEASON = TC.SEASON
    join PlayerTeamsCount PTC on PlayerSeason.PLAYER_ID = PTC.PLAYER_ID group by PlayerSeason.PLAYER_ID
/* PlayerAdjustedTeamsNumber(PLAYER_NAME,PLAYER_ID,AverageTeamNumber,FirstYear,CareerLength,LastYear,PlayerTeamNumber,AdjustedTeamNumber) */;
***********************************
