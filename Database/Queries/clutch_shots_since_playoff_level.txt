with
    LevelsClutchShots as (
        select SEASON, SerieOrder, group_concat(distinct LevelTitle) as Titles,
               count(*) filter ( where RemainingSeconds <= 300 and Period >= 4 and abs(ScoreMargin) <= 5 and ShotValue >= 2 ) as ClutchShots,
               count(distinct PlayerAId) filter ( where RemainingSeconds <= 300 and Period >= 4 and abs(ScoreMargin) <= 5 and ShotValue >= 2 ) as ClutchShotsPlayers,
               count(distinct GameId) as GamesCount
        from PlayoffShots
        group by SEASON, SerieOrder
    ),
    SinceLevel as (
        select SEASON, SerieOrder, Titles,
               sum(ClutchShots) over W1 as ClutchShots,
               sum(ClutchShotsPlayers) over W1 as ClutchShotsPlayers,
               sum(GamesCount) over W1 as GamesCount
        from LevelsClutchShots
        window W1 as (partition by SEASON order by SerieOrder rows between unbounded preceding and current row )
    ),
    WithRatio as (
        select *,
               ClutchShots*1.0 / GamesCount as ClutchShotsPerGame
        from SinceLevel
    ),
    Ranked as (
        select *,
               rank() over (partition by SerieOrder order by ClutchShots desc ) as ClutchShotsRank,
               rank() over (partition by SerieOrder order by ClutchShotsPerGame desc ) as ClutchShotsPerGameRank,
               rank() over (partition by SerieOrder order by ClutchShotsPlayers desc ) as ClutchShotsPlayersRank
        from WithRatio
    )
select *
from Ranked
order by ClutchShotsRank + ClutchShotsPerGameRank + ClutchShotsPlayersRank